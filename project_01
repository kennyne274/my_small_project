# 현재 디렉토리에서 파일만 검색한 후 인코딩 후 텍스트에 출력하는 간단한 프로그램
# 아직 작성 중, 연습용

from tkinter import *
from tkinter import messagebox
import os

def file_list():
    listbox.delete(0, END)
    files = [f for f in os.listdir(".") if os.path.isfile(os.path.join(".", f))]  

    for file in files:
        listbox.insert(END, file)

def delete():
    listbox.delete(0, END)
    text.delete(1.0, END)

def ch():
    selection = listbox.curselection()  
    if not selection:
        return
    
    index = selection[0]               
    selected_file = listbox.get(index)  

    entry.delete(0, END)                
    entry.insert(0, selected_file)      

def load_file():
    filename = entry.get()       
    if not os.path.isfile(filename): 
        text.delete(1.0, END)
        text.insert(END, "파일이 존재하지 않습니다.")
        return
    try:
        with open(filename, "r", encoding="utf-8") as f:  
            content = f.read()

        text.delete(1.0, END)          
        text.insert(END, content)    
    except Exception as e:
            text.delete(1.0, END)          
            text.insert(END, f"{e}") 

def on_double_click(event):
    ch()          # 리스트에서 선택 → Entry에 파일명
    load_file()  

def save_file():
    filename = entry.get()

    if not filename:
        text.delete(1.0, END)
        text.insert(END, "저장할 파일명이 없습니다.")
        return

    try:
        content = text.get(1.0, END).rstrip()
        with open(filename, "w", encoding="utf-8") as f:
            f.write(content)

        text.insert(END, "")
    except Exception as e:
        text.delete(1.0, END)
        text.insert(END, f"저장 실패: {e}")
   

def copy_to_clipboard():
    root.clipboard_clear()
    content = text.get("1.0", END)
    root.clipboard_append(content)
    messagebox.showinfo("복사 완료", "클립보드로 복사 되었습니다")
   


root = Tk()
root.title("현재 디렉토리의 파일 검색")
root.resizable(False, False)

scrollbar = Scrollbar(root)
scrollbar.grid(row=0, column=3, sticky='ns')
listbox = Listbox(root)
listbox.bind("<Double-Button-1>", on_double_click)
listbox.config(yscrollcommand=scrollbar.set)
scrollbar.config(command=listbox.yview)

entry = Entry(root)

scrollbar2 = Scrollbar(root)
scrollbar2.grid(row=2, column=3, sticky='ns')
text = Text(root)
text.config(yscrollcommand=scrollbar2.set)
scrollbar2.config(command=text.yview)

btn = Button(root, text = "파일 목록", command=file_list)

btn2 = Button(root, text = "내용 복사", command=copy_to_clipboard)
btn4 = Button(root, text = "Reset", command=delete)
btn3 = Button(root, text = "파일저장", command=save_file)
listbox.grid(row=0, column=0, columnspan=3, sticky='ew')
btn.grid(row=1, column=0,  sticky='ew')
entry.grid(row=1, column=1, columnspan=2, sticky='ew')

text.grid(row=2, column=0, columnspan=3, sticky='ew')
btn2.grid(row=3, column=0, sticky='ew')
btn3.grid(row=3, column=1, sticky='ew')
btn4.grid(row=3, column=2, sticky='ew')


root.mainloop()
